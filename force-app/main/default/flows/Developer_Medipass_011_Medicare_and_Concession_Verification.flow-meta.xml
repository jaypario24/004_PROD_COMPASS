<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Copy_2_of_Extract_JSON_Values_Action_1</name>
        <label>Copy 2 of Extract JSON Values Action 1</label>
        <locationX>314</locationX>
        <locationY>674</locationY>
        <actionName>ExtractJSONValues</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>inputJSONString</name>
            <value>
                <elementReference>responseBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>keysToExtract</name>
            <value>
                <stringValue>[{&quot;key&quot;:&quot;value1&quot;,&quot;value&quot;:&quot;patientVerified&quot;,&quot;order&quot;:0},{&quot;key&quot;:&quot;value2&quot;,&quot;value&quot;:&quot;isUpdateRequired&quot;,&quot;order&quot;:1},{&quot;key&quot;:&quot;value3&quot;,&quot;value&quot;:&quot;patient.message&quot;,&quot;order&quot;:2},{&quot;key&quot;:&quot;value4&quot;,&quot;value&quot;:&quot;concessionVerified&quot;,&quot;order&quot;:3},{&quot;key&quot;:&quot;value5&quot;,&quot;value&quot;:&quot;concession.message&quot;,&quot;order&quot;:4}]</stringValue>
            </value>
        </inputParameters>
        <nameSegment>ExtractJSONValues</nameSegment>
        <outputParameters>
            <assignToReference>patientVerified</assignToReference>
            <name>value1</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isUpdateRequired</assignToReference>
            <name>value2</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>patient_message</assignToReference>
            <name>value3</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>concessionVerified</assignToReference>
            <name>value4</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>concession_message</assignToReference>
            <name>value5</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Extract_JSON_Values_Action_1</name>
        <label>Extract JSON Values Action 1</label>
        <locationX>50</locationX>
        <locationY>674</locationY>
        <actionName>ExtractJSONValues</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>inputJSONString</name>
            <value>
                <elementReference>responseBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>keysToExtract</name>
            <value>
                <stringValue>[{&quot;key&quot;:&quot;value1&quot;,&quot;value&quot;:&quot;patientVerified&quot;,&quot;order&quot;:0},{&quot;key&quot;:&quot;value2&quot;,&quot;value&quot;:&quot;isUpdateRequired&quot;,&quot;order&quot;:1},{&quot;key&quot;:&quot;value3&quot;,&quot;value&quot;:&quot;patient.message&quot;,&quot;order&quot;:2}]</stringValue>
            </value>
        </inputParameters>
        <nameSegment>ExtractJSONValues</nameSegment>
        <outputParameters>
            <assignToReference>patientVerified</assignToReference>
            <name>value1</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>isUpdateRequired</assignToReference>
            <name>value2</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>patient_message</assignToReference>
            <name>value3</name>
        </outputParameters>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>assign_dob_unformatted</name>
        <label>assign_dob_unformatted</label>
        <locationX>182</locationX>
        <locationY>242</locationY>
        <assignmentItems>
            <assignToReference>dobString_Y</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.Birthdate__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Vars</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Vars</name>
        <label>Assign_Vars</label>
        <locationX>182</locationX>
        <locationY>350</locationY>
        <assignmentItems>
            <assignToReference>verificationType_N</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>verification_type_decision</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>firstName_Y</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.FirstName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>lastName_Y</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.LastName</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sex_C</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.First_Letter_of_Sex__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>membershipNumber_Y</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.Medicare_Number__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>cardRank_Y</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>getPatient.Medicare__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>providerNumber_N</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>059748GJ</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>verification_type_OPV</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>verification_type_OPV</name>
        <label>verification_type_OPV</label>
        <locationX>182</locationX>
        <locationY>458</locationY>
        <defaultConnector>
            <targetReference>Copy_2_of_Developer_Medipass_000_Empty_HTTP_Callout_Action_Flow_1</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>isCEV</defaultConnectorLabel>
        <rules>
            <name>isOPV</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>verificationType_N</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>opv</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Developer_Medipass_000_Empty_HTTP_Callout_Action_Flow_1</targetReference>
            </connector>
            <label>isOPV</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>dob_formatted</name>
        <dataType>String</dataType>
        <expression>TEXT(YEAR(DATEVALUE(
    MID({!dobString_Y}, 7, 4) &amp; &quot;-&quot; &amp;
    MID({!dobString_Y}, 4, 2) &amp; &quot;-&quot; &amp;
    LEFT({!dobString_Y}, 2)
))) &amp; &quot;-&quot; &amp;
CASE(
    MID({!dobString_Y}, 4, 2),
    &quot;01&quot;, &quot;01&quot;,
    &quot;02&quot;, &quot;02&quot;,
    &quot;03&quot;, &quot;03&quot;,
    &quot;04&quot;, &quot;04&quot;,
    &quot;05&quot;, &quot;05&quot;,
    &quot;06&quot;, &quot;06&quot;,
    &quot;07&quot;, &quot;07&quot;,
    &quot;08&quot;, &quot;08&quot;,
    &quot;09&quot;, &quot;09&quot;,
    &quot;10&quot;, &quot;10&quot;,
    &quot;11&quot;, &quot;11&quot;,
    &quot;12&quot;, &quot;12&quot;,
    &quot;00&quot;
) &amp; &quot;-&quot; &amp;
TEXT(DAY(DATEVALUE(
    MID({!dobString_Y}, 7, 4) &amp; &quot;-&quot; &amp;
    MID({!dobString_Y}, 4, 2) &amp; &quot;-&quot; &amp;
    LEFT({!dobString_Y}, 2)
)))</expression>
    </formulas>
    <interviewLabel>Developer_Medipass_[001_Medicare_and_Concession_Verification] {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Developer_Medipass_[001_Medicare_and_Concession_Verification]</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>getPatient</name>
        <label>getPatient</label>
        <locationX>182</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>assign_dob_unformatted</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>56</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>getPatient</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Copy_2_of_Developer_Medipass_000_Empty_HTTP_Callout_Action_Flow_1</name>
        <label>Copy 2 of Developer_Medipass_[000_Empty_HTTP_Callout_Action] Flow 1</label>
        <locationX>314</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>Copy_2_of_Extract_JSON_Values_Action_1</targetReference>
        </connector>
        <flowName>Developer_Medipass_000_Empty_HTTP_Callout_Action</flowName>
        <inputAssignments>
            <name>body</name>
            <value>
                <elementReference>varText_Body</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header1value</name>
            <value>
                <stringValue>Bearer 620b16494ae4220058cacae1:Vt_dkvwolzEiglDselceOhNvPoj3UciKvVjWNB3Hkac</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header2value</name>
            <value>
                <stringValue>application/json</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header3value</name>
            <value>
                <stringValue>pariosolutions-web</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>http_method</name>
            <value>
                <stringValue>POST</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>url</name>
            <value>
                <stringValue>https://api-au.medipass.io/v3/medicare/verify</stringValue>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>responseBody</assignToReference>
            <name>response_body</name>
        </outputAssignments>
    </subflows>
    <subflows>
        <name>Developer_Medipass_000_Empty_HTTP_Callout_Action_Flow_1</name>
        <label>Developer_Medipass_[000_Empty_HTTP_Callout_Action] Flow 1</label>
        <locationX>50</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>Extract_JSON_Values_Action_1</targetReference>
        </connector>
        <flowName>Developer_Medipass_000_Empty_HTTP_Callout_Action</flowName>
        <inputAssignments>
            <name>body</name>
            <value>
                <elementReference>varText_Body</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header1value</name>
            <value>
                <stringValue>Bearer 620b16494ae4220058cacae1:Vt_dkvwolzEiglDselceOhNvPoj3UciKvVjWNB3Hkac</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header2value</name>
            <value>
                <stringValue>application/json</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>header3value</name>
            <value>
                <stringValue>pariosolutions-web</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>http_method</name>
            <value>
                <stringValue>POST</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>url</name>
            <value>
                <stringValue>https://api-au.medipass.io/v3/medicare/verify</stringValue>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>responseBody</assignToReference>
            <name>response_body</name>
        </outputAssignments>
    </subflows>
    <textTemplates>
        <name>varText_Body</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{
    &quot;verificationType&quot;: &quot;{!verificationType_N}&quot;,
    &quot;firstName&quot;: &quot;{!firstName_Y}&quot;,
    &quot;lastName&quot;: &quot;{!lastName_Y}&quot;,
    &quot;dobString&quot;: &quot;{!dob_formatted}&quot;,
    &quot;sex&quot;: &quot;{!sex_C}&quot;,
    &quot;membershipNumber&quot;: &quot;{!membershipNumber_Y}&quot;,
    &quot;cardRank&quot;: &quot;{!cardRank_Y}&quot;,
    &quot;providerNumber&quot;: &quot;{!providerNumber_N}&quot;
}</text>
    </textTemplates>
    <variables>
        <name>cardRank_Y</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>concession_message</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>concessionVerified</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>dobString_Y</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>firstName_Y</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>isUpdateRequired</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>lastName_Y</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>membershipNumber_Y</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>patient_dobString_M</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>patient_message</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>patientVerified</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>providerNumber_N</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>responseBody</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>serviceDate_N</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>sex_C</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varBaseURL</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>{Base URL}/v3/medicare/verify</stringValue>
        </value>
    </variables>
    <variables>
        <name>verification_type_decision</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>opv</stringValue>
        </value>
    </variables>
    <variables>
        <name>verificationType_N</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
